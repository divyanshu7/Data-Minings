---
title: "Clustering_Credit_card"
author: "Divaynshu Goswami"
date: "February 28, 2019"
output: html_document
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


                                Problem Statement
Data is of various customers of a bank with their credit limit , the total number of credit cards the customer has , and different channels through which customer has contacted the bank for any queries , different channels include visiting to bank , online and through call centre.

Marketing team plans to display offer ads on digital platform but only wants to target customers who are digitally more active , hence can we built different clusters of different channels so that based on different requirements the marketing team will target only customers falling under a particular cluster rather than targeting all the customers.

Note: This data is a completely dummy data and is created for this practical example only, it does not have any relevance to any organization.


                                    Solution

We can provide a solution by clustering / segmenting customers and indentifying their profile.

```{r extract data}
mydata<- read.csv('data_csv.csv')

```

Scale the data to make it unitless and calculate the distance matrix.

```{r, distance matrix}
#scale the data
mydata_scld <- scale(mydata[,3:7])
head(mydata_scld, 10)

#Calculate distance matrix
mydata_dist <- dist(x=mydata_scld, method = "euclidean")
print(mydata_dist,digits = 3)
```

Form clusters by using a hierarchal technique and plot a dendogram to identify the appropriate number of clusters.

```{r, form clusters}
require(graphics)
clust <- hclust(mydata_dist, method = "average")
plot(clust, labels =  as.character(mydata[,2]))
x <- rect.hclust(clust, k=3, border="blue")
```

Perform profiling of clusters on the main data

```{r, profiling }
mydata$cluster <- cutree(clust,k=3)
mydata_agg <- aggregate(mydata[,-c(1,2)], list(mydata$cluster), mean)
clust_profile <- data.frame(cluster=mydata_agg[,1], freq=as.vector(table(mydata$cluster)),mydata_agg[,-1])

print(clust_profile)

```

Hence, we can see that

Cluster 1 is of customers who make on an average 1 visit per month to the bank and have moderate credit limit of Rs. 60,000. Hence these customers can be targetted for ofline marketing of products.

Cluster 2 consists customers who have lowest credit limit but make around 5 to 6 calls in a month to ask queries. Hence marketing team should target these customers for phone banking services and products.

Cluster 3 is consist of customers who make most visits through online channels and also have highest average credit limit. Hence marketing team should target customers in cluster 3 for onlline marketing of products and offers. 


Performing non hirarichal clustering K means
```{r}

#Create a wss function
wssplot <- function(data, nc=15, seed=1234){
  wss <- (nrow(data)-1)*sum(apply(data,2,var))
  for (i in 2:nc){
    set.seed(seed)
    wss[i] <- sum(kmeans(data, centers=i)$withinss)}
  plot(1:nc, wss, type="b", xlab="Number of Clusters",
       ylab="Within groups sum of squares")}

# use scaled data
wssplot(mydata_scld, nc=5)

```

We can see the elbow on the above graph to decide the number of clusters. 

We will create 3 clusters using K-means clustering

```{r}
#nstart = 10 it will do the clustering process 25 times for each observation to check consistency of the obsevation on every iteration
clust_Km = kmeans(x=mydata_scld, centers = 3, nstart = 10)
clust_Km
```

Let's do the profiling of clusters

```{r}
## profiling the clusters
mydata$ClustersK <- clust_Km$cluster
mydata
aggr = aggregate(mydata[,-c(1,2, 8)],list(mydata$ClustersK),mean)
clust_km_profile <- data.frame( Cluster=aggr[,1],
                            Freq=as.vector(table(mydata$ClustersK)),
                            aggr[,-1])


#Output
print(clust_km_profile)
```

We get the same profiles of customers.
